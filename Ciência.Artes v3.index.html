<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura-Vibration Matrix | MOD.010 - Instalação Completa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        
        body {
            font-family: 'Space Mono', monospace;
            background-color: #000;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            margin: 0;
        }

        .glass-panel {
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        input[type=range] {
            height: 4px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 14px;
            width: 14px;
            border-radius: 50%;
            background: #22c55e;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.6);
        }

        .scanline {
            width: 100%;
            height: 100px;
            z-index: 5;
            background: linear-gradient(0deg, rgba(0, 0, 0, 0) 0%, rgba(34, 197, 94, 0.03) 50%, rgba(0, 0, 0, 0) 100%);
            position: absolute;
            bottom: 100%;
            animation: scanline 8s linear infinite;
            pointer-events: none;
        }

        @keyframes scanline {
            0% { bottom: 100%; }
            100% { bottom: -100px; }
        }

        canvas {
            display: block;
            touch-action: none;
        }

        .glow-text {
            text-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        .layer-active {
            border-color: #22c55e !important;
            background: rgba(34, 197, 94, 0.15) !important;
            color: #22c55e !important;
        }
        
        .audio-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.4; }
            50% { opacity: 1; }
            100% { opacity: 0.4; }
        }
    </style>
</head>
<body class="flex flex-col md:flex-row">
    <div class="scanline"></div>

    <!-- Sidebar de Controle -->
    <aside class="w-full md:w-80 h-auto md:h-full border-b md:border-b-0 md:border-r border-white/10 bg-[#0a0a0a] flex flex-col z-20">
        <div class="p-6 border-b border-white/10">
            <div class="flex items-center gap-2 mb-2 text-green-500">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z"/></svg>
                <span class="text-[9px] tracking-[0.4em] uppercase opacity-70">Afrokódica Experimental</span>
            </div>
            <h1 class="text-xl font-bold tracking-tighter italic glow-text">CONCEITO: LUZ & SOM</h1>
            <p class="text-[9px] text-gray-500 mt-1 uppercase tracking-tighter">Instalação Sensorial MOD.010</p>
        </div>

        <div class="flex-1 overflow-y-auto p-6 space-y-8">
            <section>
                <label class="text-[10px] uppercase tracking-widest text-gray-400 mb-6 block">Parâmetros de Ressonância</label>
                
                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between text-[11px] mb-2">
                            <span>Amplitude Geométrica</span>
                            <span id="amp-val" class="text-green-400">1.2</span>
                        </div>
                        <input type="range" id="amp-range" min="0.5" max="5" step="0.1" value="1.2" class="w-full">
                    </div>
                    
                    <div>
                        <div class="flex justify-between text-[11px] mb-2">
                            <span>Frequência (Hz)</span>
                            <span id="freq-val" class="text-green-400">432 Hz</span>
                        </div>
                        <input type="range" id="freq-range" min="100" max="800" step="1" value="432" class="w-full">
                    </div>

                    <div>
                        <div class="flex justify-between text-[11px] mb-2">
                            <span>Inércia da Dança</span>
                            <span id="iner-val" class="text-green-400">0.95</span>
                        </div>
                        <input type="range" id="iner-range" min="0.80" max="0.99" step="0.01" value="0.95" class="w-full">
                    </div>
                </div>
            </section>

            <section class="pt-4">
                <label class="text-[10px] uppercase tracking-widest text-gray-400 mb-4 block">Modos de Instalação</label>
                <div class="grid grid-cols-2 gap-2">
                    <button id="mode-cymatic" class="p-3 text-[9px] border border-white/10 transition-all layer-active uppercase">Cimática</button>
                    <button id="mode-kinetic" class="p-3 text-[9px] border border-white/10 transition-all uppercase">Cinética</button>
                    <button id="mode-phi" class="p-3 text-[9px] border border-white/10 transition-all uppercase">Áurea</button>
                    <button id="mode-aura" class="p-3 text-[9px] border border-white/10 transition-all uppercase">Aura</button>
                </div>
            </section>
        </div>

        <div class="p-6 bg-green-500/5 mt-auto">
            <p class="text-[8px] text-gray-500 mb-4 text-center italic">Ative o áudio para ouvir a luz.</p>
            <button id="btn-audio" class="w-full py-3 bg-red-900/20 text-red-500 border border-red-500/30 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-green-500 transition-colors">
                AUDIO: OFF
            </button>
        </div>
    </aside>

    <!-- Main Viewport -->
    <main class="flex-1 relative overflow-hidden bg-black">
        <div class="absolute top-0 left-0 w-full p-8 flex justify-between items-start pointer-events-none z-10">
            <div>
                <h2 id="mode-title" class="text-3xl font-black tracking-tighter opacity-30 italic">CIMÁTICA.V01</h2>
                <div class="flex gap-4 mt-1">
                    <div class="flex items-center gap-2 text-[10px] text-green-500 uppercase tracking-[0.2em]">
                        <span class="inline-block w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                        Fluxo Energético Ativo
                    </div>
                </div>
            </div>
            
            <div class="glass-panel p-4 rounded hidden md:flex gap-8">
                <div class="text-center border-r border-white/10 pr-6">
                    <p class="text-[8px] opacity-50 uppercase">Oscilação</p>
                    <p id="tension-ui" class="text-xs font-bold">0.844</p>
                </div>
                <div class="text-center">
                    <p class="text-[8px] opacity-50 uppercase">Vetor Artístico</p>
                    <p id="vector-ui" class="text-xs font-bold tracking-tighter">0.0, 0.0</p>
                </div>
            </div>
        </div>

        <canvas id="mainCanvas"></canvas>

        <!-- Legend Overlay -->
        <div class="absolute bottom-8 right-8 left-8 flex flex-col md:flex-row justify-between items-end pointer-events-none gap-4">
            <div class="max-w-sm bg-black/60 backdrop-blur-md p-4 border-l-2 border-green-500">
                <p id="mode-description" class="text-[10px] leading-relaxed text-gray-300">
                    <span class="text-green-500 font-bold tracking-widest uppercase">[CIMÁTICA]</span><br>
                    O som torna-se visível. Padrões de interferência harmônica criam geometrias sagradas baseadas na frequência de ressonância da sala virtual.
                </p>
            </div>
            <div class="text-right">
                <p class="text-[10px] text-green-500 font-bold uppercase tracking-widest mb-1">Status do Sensor</p>
                <div class="flex gap-1 justify-end">
                    <div id="audio-indicator" class="w-2 h-2 rounded-full bg-white/20"></div>
                    <div class="w-1 h-3 bg-green-500/40"></div>
                    <div class="w-1 h-3 bg-green-500/60"></div>
                    <div class="w-1 h-3 bg-green-500"></div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        
        // Estado Global
        let params = {
            amplitude: 1.2,
            frequency: 432,
            inertia: 0.95,
            mode: 'cymatic',
            audioActive: false
        };

        // Web Audio Setup
        let audioCtx, oscillator, gainNode;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                oscillator = audioCtx.createOscillator();
                gainNode = audioCtx.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(params.frequency, audioCtx.currentTime);
                
                gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
                
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                oscillator.start();
            }
        }

        const descriptions = {
            cymatic: { title: "CIMÁTICA.V01", desc: "<span class='text-green-500 font-bold uppercase'>[CIMÁTICA]</span><br>O som torna-se visível. Padrões de interferência harmônica criam geometrias baseadas em frequências puras." },
            kinetic: { title: "CINÉTICA.V02", desc: "<span class='text-green-500 font-bold uppercase'>[CINÉTICA]</span><br>A física da dança traduzida em partículas. O movimento do corpo cria vácuos de luz e arrasto inercial." },
            phi: { title: "ÁUREA.V03", desc: "<span class='text-green-500 font-bold uppercase'>[ÁUREA]</span><br>Geometria sagrada em fluxo. Partículas seguem a Proporção Áurea (Phi) criando espirais de crescimento infinito." },
            aura: { title: "AURA.V04", desc: "<span class='text-green-500 font-bold uppercase'>[AURA]</span><br>Emissão orgânica de energia. Campos de força bioelétricos representados por difusão de partículas sensoriais." }
        };

        let particles = [];
        let mouse = { x: -1000, y: -1000, active: false, vx: 0, vy: 0 };
        let lastMouse = { x: 0, y: 0 };

        // UI Handlers
        document.getElementById('amp-range').oninput = (e) => {
            params.amplitude = parseFloat(e.target.value);
            document.getElementById('amp-val').textContent = params.amplitude.toFixed(1);
        };
        document.getElementById('freq-range').oninput = (e) => {
            params.frequency = parseInt(e.target.value);
            document.getElementById('freq-val').textContent = params.frequency + ' Hz';
            if (oscillator && params.audioActive) {
                oscillator.frequency.setTargetAtTime(params.frequency, audioCtx.currentTime, 0.1);
            }
        };
        document.getElementById('iner-range').oninput = (e) => {
            params.inertia = parseFloat(e.target.value);
            document.getElementById('iner-val').textContent = params.inertia.toFixed(2);
        };

        const setMode = (mode) => {
            params.mode = mode;
            ['cymatic', 'kinetic', 'phi', 'aura'].forEach(m => {
                document.getElementById(`mode-${m}`).classList.toggle('layer-active', m === mode);
            });
            document.getElementById('mode-title').textContent = descriptions[mode].title;
            document.getElementById('mode-description').innerHTML = descriptions[mode].desc;
            initParticles();
        };

        document.getElementById('mode-cymatic').onclick = () => setMode('cymatic');
        document.getElementById('mode-kinetic').onclick = () => setMode('kinetic');
        document.getElementById('mode-phi').onclick = () => setMode('phi');
        document.getElementById('mode-aura').onclick = () => setMode('aura');

        document.getElementById('btn-audio').onclick = function() {
            initAudio();
            params.audioActive = !params.audioActive;
            if (params.audioActive) {
                gainNode.gain.setTargetAtTime(0.1, audioCtx.currentTime, 0.2);
                this.textContent = "AUDIO: ON";
                this.className = "w-full py-3 bg-white text-black text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-green-500 transition-colors";
                document.getElementById('audio-indicator').classList.add('bg-green-500', 'audio-pulse');
            } else {
                gainNode.gain.setTargetAtTime(0, audioCtx.currentTime, 0.2);
                this.textContent = "AUDIO: OFF";
                this.className = "w-full py-3 bg-red-900/20 text-red-500 border border-red-500/30 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-green-500 transition-colors";
                document.getElementById('audio-indicator').classList.remove('bg-green-500', 'audio-pulse');
            }
        };

        function resize() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
            initParticles();
        }

        class Particle {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.accX = 0;
                this.accY = 0;
                this.size = Math.random() * 2 + 0.5;
                this.color = `hsla(${140 + Math.random() * 40}, 80%, 50%, ${Math.random() * 0.4 + 0.1})`;
                this.phi = Math.random() * Math.PI * 2;
            }

            update() {
                // MODOS DE INSTALAÇÃO
                switch(params.mode) {
                    case 'cymatic':
                        let f = params.frequency * 0.005;
                        let wave = Math.sin(this.x * 0.01 * f) * Math.cos(this.y * 0.01 * f) * params.amplitude;
                        this.accX += Math.cos(wave * Math.PI) * 0.2;
                        this.accY += Math.sin(wave * Math.PI) * 0.2;
                        break;
                    
                    case 'phi':
                        let angle = (this.phi += 0.02);
                        let radius = (params.frequency / 10);
                        this.accX += Math.cos(angle) * (radius/500);
                        this.accY += Math.sin(angle) * (radius/500);
                        break;
                        
                    case 'aura':
                        this.accX += (Math.random() - 0.5) * 0.5 * params.amplitude;
                        this.accY += (Math.random() - 0.5) * 0.5 * params.amplitude;
                        break;
                }

                // Interação com Cursor (Física da Dança)
                if (mouse.active) {
                    let dx = mouse.x - this.x;
                    let dy = mouse.y - this.y;
                    let dist = Math.sqrt(dx*dx + dy*dy);
                    let limit = 250;
                    
                    if (dist < limit) {
                        let force = (limit - dist) / limit;
                        if (params.mode === 'kinetic') {
                            // No modo cinético o cursor repele com rastro
                            this.accX -= (dx / dist) * force * 1.2;
                            this.accY -= (dy / dist) * force * 1.2;
                        } else {
                            // Nos outros modos o cursor atrai suavemente
                            this.accX += (dx / dist) * force * 0.8;
                            this.accY += (dy / dist) * force * 0.8;
                        }
                        this.accX += mouse.vx * 0.1 * force;
                        this.accY += mouse.vy * 0.1 * force;
                    }
                }

                this.vx += this.accX;
                this.vy += this.accY;
                this.vx *= params.inertia;
                this.vy *= params.inertia;
                this.x += this.vx;
                this.y += this.vy;

                // Screen Wrap
                if (this.x < 0) this.x = canvas.width;
                if (this.x > canvas.width) this.x = 0;
                if (this.y < 0) this.y = canvas.height;
                if (this.y > canvas.height) this.y = 0;

                this.accX = 0;
                this.accY = 0;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initParticles() {
            particles = [];
            const counts = { cymatic: 1500, kinetic: 1000, phi: 1200, aura: 800 };
            let count = counts[params.mode];
            for (let i = 0; i < count; i++) {
                particles.push(new Particle());
            }
        }

        const handleMove = (e) => {
            const rect = canvas.getBoundingClientRect();
            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            
            mouse.x = cx - rect.left;
            mouse.y = cy - rect.top;
            mouse.active = true;
            
            mouse.vx = mouse.x - lastMouse.x;
            mouse.vy = mouse.y - lastMouse.y;
            lastMouse.x = mouse.x;
            lastMouse.y = mouse.y;

            document.getElementById('vector-ui').textContent = `${mouse.vx.toFixed(1)}, ${mouse.vy.toFixed(1)}`;
            
            // Som reativo ao movimento (Pitch bend)
            if (params.audioActive && oscillator) {
                let mod = (mouse.vx + mouse.vy) * 2;
                oscillator.frequency.setTargetAtTime(params.frequency + mod, audioCtx.currentTime, 0.1);
            }
        };

        canvas.addEventListener('mousemove', handleMove);
        canvas.addEventListener('touchstart', (e) => { handleMove(e); mouse.active = true; });
        canvas.addEventListener('touchmove', handleMove);
        canvas.addEventListener('touchend', () => { 
            mouse.active = false; 
            if (oscillator) oscillator.frequency.setTargetAtTime(params.frequency, audioCtx.currentTime, 0.5);
        });
        canvas.addEventListener('mouseleave', () => { 
            mouse.active = false; 
            if (oscillator) oscillator.frequency.setTargetAtTime(params.frequency, audioCtx.currentTime, 0.5);
        });

        function animate() {
            // Trail effect (persitência visual)
            let trail = params.mode === 'aura' ? 0.05 : 0.15;
            ctx.fillStyle = `rgba(0, 0, 0, ${trail})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach(p => {
                p.update();
                p.draw();
            });

            // Feedback Visual de Movimento
            if (mouse.active) {
                const grad = ctx.createRadialGradient(mouse.x, mouse.y, 0, mouse.x, mouse.y, 180);
                let color = params.mode === 'kinetic' ? 'rgba(255, 255, 255, 0.05)' : 'rgba(34, 197, 94, 0.08)';
                grad.addColorStop(0, color);
                grad.addColorStop(1, 'transparent');
                ctx.fillStyle = grad;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', resize);
        resize();
        window.onload = animate;
    </script>
</body>
</html>